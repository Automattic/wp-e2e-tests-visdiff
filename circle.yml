machine:
  node:
    version: 5.11.1

checkout:
  post:
    - git submodule init
    - git submodule update --remote --force

dependencies:
  cache_directories:
    - "wp-e2e-tests/node_modules"
  override:
    - cd wp-e2e-tests && npm pack lib/reporter
    - cd wp-e2e-tests && npm install ./spec-xunit-slack-reporter-0.0.1.tgz
    - cd wp-e2e-tests && npm install

test:
  override:
    - echo "Running visdiff tests on branch ${E2E_BRANCH-master} with the following browsers - ${BROWSERS-all}"
    - cd wp-e2e-tests && git checkout ${E2E_BRANCH-master} && ./run.sh -v ${BROWSERS-all}
